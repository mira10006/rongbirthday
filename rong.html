<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For Rong | Birthday </title>
    <style>
        :root {
            --bg-deep: #0a0a12;
            --rose-gold: #e5b3b3;
            --gold-gradient: linear-gradient(135deg, #d4af37 0%, #f9e29c 50%, #b8860b 100%);
            --glass-white: rgba(255, 255, 255, 0.05);
            --border-glass: rgba(255, 255, 255, 0.15);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body, html {
            margin: 0; padding: 0; width: 100%;
            font-family: 'Times New Roman', 'PingFang TC', serif;
            background: var(--bg-deep);
            color: #fff; overflow-x: hidden;
            scroll-behavior: smooth;
        }

        .luxury-bg {
            position: fixed; width: 100%; height: 100%; z-index: -1;
            background: radial-gradient(circle at 50% 50%, #1a1a2e 0%, #05050a 100%);
        }

        section { min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px 20px; position: relative; }

        .hero h1 {
            font-size: 2.8rem; text-align: center; letter-spacing: 8px;
            text-transform: uppercase; font-weight: 200;
            background: var(--gold-gradient);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        /* --- ç•™è¨€å€ --- */
        .stage-container {
            background: var(--glass-white); backdrop-filter: blur(15px);
            border: 1px solid var(--border-glass); border-radius: 40px;
            padding: 40px 20px; width: 100%; max-width: 450px; position: relative;
        }
        .floating-item {
            position: absolute; width: 50px; height: 50px;
            border: 1px solid var(--rose-gold); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; background: rgba(229, 179, 179, 0.1); z-index: 20;
        }
        .message-popup {
            position: absolute; width: 140px; padding: 10px;
            background: rgba(255, 255, 255, 0.98); color: #444;
            border-radius: 4px; font-size: 0.8rem; border-left: 3px solid #d4af37;
            pointer-events: none; z-index: 10; opacity: 0; transition: 0.6s;
        }

        /* --- æ—‹è½‰æœ¨é¦¬å€ --- */
        .carousel-box { 
            position: relative; width: 100%; height: 420px; 
            perspective: 2000px; display: flex; justify-content: center; align-items: center;
        }
        .card-item {
            position: absolute; width: 200px; height: 280px;
            transition: all 0.8s cubic-bezier(0.2, 1, 0.3, 1);
            transform-style: preserve-3d;
            left: 50%; top: 50%; margin-left: -100px; margin-top: -140px;
            cursor: pointer;
        }
        
        .card-item.center { transform: translateX(0) translateZ(150px); z-index: 10; opacity: 1; }
        .card-item.left { transform: translateX(-110px) translateZ(0) rotateY(45deg); opacity: 0.3; }
        .card-item.right { transform: translateX(110px) translateZ(0) rotateY(-45deg); opacity: 0.3; }

        .card-item.is-active { 
            transform: translateY(-80px) translateZ(350px) rotateY(180deg) !important; 
            z-index: 100 !important; opacity: 1 !important;
        }

        .card-inner { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 12px; border: 1px solid var(--rose-gold); overflow: hidden; }
        .card-back { background: #111; display: flex; justify-content: center; align-items: center; font-size: 2.5rem; }
        .card-front { background: #000; transform: rotateY(180deg); }
        canvas { position: absolute; top: 0; left: 0; }

        .btn-group { display: flex; gap: 20px; margin-top: 20px; z-index: 999; }
        .nav-btn {
            background: transparent; color: var(--rose-gold);
            border: 1px solid var(--rose-gold); padding: 10px 25px;
            border-radius: 2px; font-size: 0.7rem; letter-spacing: 3px;
        }

        .hint-text { font-size: 0.7rem; color: var(--rose-gold); margin-top: 15px; opacity: 0.6; }
    </style>
</head>
<body onclick="resetSelection(event)">

    <div class="luxury-bg"></div>

    <section class="hero">
        <h1>For Rong</h1>
        <p>2026 BIRTHDAY</p>
    </section>

    <section>
        <div class="stage-container">
            <p style="text-align: center; font-size: 0.7rem; letter-spacing: 3px; margin-bottom: 40px; color: var(--rose-gold);">é»æ“Šé–‹å•Ÿ</p>
            <div style="position:relative; height:320px; width:100%;" id="msgRoot">
                <div class="floating-item" style="top:10%; left:15%;" onclick="popMsg(this, 'è“‰è“‰ç”Ÿæ—¥å¿«æ¨‚ã€‚'); event.stopPropagation();">ğŸ¦œ</div>
                <div class="floating-item" style="top:30%; right:15%;" onclick="popMsg(this, 'ç¥ä½ æ„›æƒ…9999ç™½é ­å•è€'); event.stopPropagation();">ğŸ½</div>
                <div class="floating-item" style="bottom:25%; left:20%;" onclick="popMsg(this, 'å¤šå¤šï¼šæ±ªæ±ªæ±ªæ±ªæ±ª'); event.stopPropagation();">ğŸ£</div>
                <div class="floating-item" style="bottom:10%; right:20%;" onclick="popMsg(this, 'åœŸè±†'); event.stopPropagation();">ğŸ¶</div>
            </div>
        </div>
    </section>

    <section id="carouselSection">
        <div class="carousel-box">
            <div class="card-item left" onclick="selectCard(this, event)">
                <div class="card-inner card-back"><span>01</span></div>
                <div class="card-inner card-front"><img src="imges/imges01.jpg" width="100%" height="100%" style="object-fit:cover;"><canvas width="200" height="280"></canvas></div>
            </div>
            <div class="card-item center" onclick="selectCard(this, event)">
                <div class="card-inner card-back"><span>02</span></div>
                <div class="card-inner card-front"><img src="imges/imges02.jpg" width="100%" height="100%" style="object-fit:cover;"><canvas width="200" height="280"></canvas></div>
            </div>
            <div class="card-item right" onclick="selectCard(this, event)">
                <div class="card-inner card-back"><span>03</span></div>
                <div class="card-inner card-front"><img src="imges/imges03.jpg" width="100%" height="100%" style="object-fit:cover;"><canvas width="200" height="280"></canvas></div>
            </div>
        </div>
        <div class="btn-group">
            <button class="nav-btn" onclick="move(-1); event.stopPropagation();">Back</button>
            <button class="nav-btn" onclick="move(1); event.stopPropagation();">Next</button>
        </div>
        <p class="hint-text">é»æ“Šå¡ç‰‡æ”¾å¤§åˆ®é–‹ï¼Œé»æ“Šç©ºç™½è™•å¯åˆ‡æ›å…¶ä»–å¼µ</p>
    </section>

    <script>
        // 1. ç•™è¨€é‚è¼¯
        function popMsg(el, txt) {
            el.style.opacity = '0.2'; el.style.pointerEvents = 'none';
            const root = document.getElementById('msgRoot');
            document.querySelectorAll('.message-popup').forEach(m => { m.style.opacity = '0.2'; m.style.transform = 'scale(0.8)'; });
            const p = document.createElement('div');
            p.className = 'message-popup'; p.innerText = txt;
            p.style.top = (el.offsetTop - 40) + "px"; p.style.left = (el.offsetLeft - 45) + "px";
            root.appendChild(p);
            setTimeout(() => { p.style.transform = 'scale(1) translateY(-10px)'; p.style.opacity = '1'; }, 50);
        }

        // 2. æ—‹è½‰æœ¨é¦¬èˆ‡é¸æ“‡é‚è¼¯
        let idx = 1;
        const items = document.querySelectorAll('.card-item');
        const states = ['left', 'center', 'right'];

        function move(d) {
            if(document.querySelector('.is-active')) return;
            idx = (idx + d + 3) % 3;
            items.forEach((item, i) => { item.className = 'card-item ' + states[(i - idx + 4) % 3]; });
        }

        function selectCard(el, e) {
            e.stopPropagation(); // é˜²æ­¢è§¸ç™¼ body çš„ resetSelection
            if (!el.classList.contains('center')) { move(el.classList.contains('left') ? -1 : 1); return; }
            
            // å¦‚æœå·²ç¶“æ˜¯ activeï¼Œå°±ä¸é‡è¤‡åŸ·è¡Œ
            if (el.classList.contains('is-active')) return;

            el.classList.add('is-active');
            items.forEach(i => { if(i!==el) i.style.opacity = '0'; });
        }

        // 3. ã€é—œéµä¿®å¾©ã€‘é‡ç½®é‚è¼¯ï¼šé»æ“Šç©ºç™½è™•è®“å¡ç‰‡ç¸®å›å»
        function resetSelection(e) {
            const activeCard = document.querySelector('.is-active');
            if (activeCard) {
                activeCard.classList.remove('is-active');
                items.forEach(i => { i.style.opacity = ''; }); // æ¢å¾©æ‰€æœ‰å¡ç‰‡å¯è¦‹åº¦
            }
        }

        // 4. åˆ®åˆ®æ¨‚åˆå§‹åŒ–
        document.querySelectorAll('canvas').forEach(can => {
            const ctx = can.getContext('2d');
            ctx.fillStyle = '#1a1a1a'; ctx.fillRect(0, 0, 200, 280);
            ctx.fillStyle = '#e5b3b3'; ctx.font = '10px Times New Roman'; ctx.textAlign = 'center';
            ctx.fillText('æ‘©æ“¦æ‘©æ“¦', 100, 140);
            let down = false;
            const draw = (e) => {
                if(!down) return;
                const activeCard = can.closest('.card-item');
                if(!activeCard.classList.contains('is-active')) return; // æ²’æ”¾å¤§ä¸èƒ½åˆ®

                const r = can.getBoundingClientRect();
                const x = (e.clientX || e.touches[0].clientX) - r.left;
                const y = (e.clientY || e.touches[0].clientY) - r.top;
                ctx.globalCompositeOperation = 'destination-out';
                ctx.beginPath(); ctx.arc(x, y, 25, 0, Math.PI*2); ctx.fill();
            };
            can.addEventListener('mousedown', () => down = true);
            can.addEventListener('touchstart', (e) => { down = true; e.stopPropagation(); });
            window.addEventListener('mouseup', () => down = false);
            window.addEventListener('touchend', () => down = false);
            can.addEventListener('mousemove', draw);
            can.addEventListener('touchmove', e => { if(down) { e.preventDefault(); e.stopPropagation(); draw(e); } }, {passive:false});
        });
    </script>
</body>
</html>